!function(t,e,i){"use strict";function a(i,a){var n,s=i.data();this.$element=i,this.options=t.extend({},o,s,a),this.$preloader=t(this.options.preloader),n=new RegExp(this.options.url.replace("{number}","(\\d+)"),"i"),this.currentPage=e.location.search.match(n)?e.location.search.match(n):1,this.lastLoadedPage=this.currentPage,this.isLoading=!1,this.init()}var n="ufiScroll",o={url:e.location.pathname+e.location.search+(e.location.search?"&page={number}":"?page={number}")+e.location.hash,pageCount:null,preloader:'<div class="preloader">Loading...</div>',selectors:{itemFirst:".ufi-item-first",itemLast:".ufi-item-last"},pagination:function(e){for(var i,a=t('<div class="ufi-pagination"/>'),n=t('<a href="#" class="ufi-pagination_page"/>'),o=t('<span class="ufi-pagination_separator">...</span>'),s=this.generatePagination(e,this.options.pageCount,3,1,1),r=0;r<s.length;r++)"string"!=typeof s[r]?(i=n.clone(),i.text(s[r]),s[r].isActive&&i.addClass("_active")):i=o.clone(),a.append(i);t("body").find(".ufi-pagination").length?t("body").find(".ufi-pagination").replaceWith(a):t("body").append(a)}};a.prototype={init:function(){this._pageItemsEnhancment(this.$element,this.currentPage),this._scrollInit(),this.options.pagination.call(this,this.currentPage)},_scrollInit:function(){var i=this._delayFunctionCall(1,50,this._scrollHandler);t(e).on("scroll.ufi",function(){i()})},_scrollHandler:function(){if(this.lastLoadedPage<this.options.pageCount){var i=t(e).scrollTop()+t(e).height(),a=this._getPagePosition(this.lastLoadedPage),n=.25*(a.bottom-a.top);i>=a.bottom-n&&this._loadPage(this.currentPage+1)}},_loadPage:function(e){var i=this;this.isLoading||(this.isLoading=!0,this._showPreloader(),t.ajax({url:this.options.url.replace("{number}",e),success:function(a){var n=t(a).find(i.$element.selector);n.length||(n=t(a)),i._pageItemsEnhancment(n,e),i.currentPage=e,i.$element.append(n.find(".item")),i.lastLoadedPage=e,i._hidePreloader(),i.isLoading=!1,i.options.pagination.call(i,i.currentPage)}}))},_showPreloader:function(){this.$element.append(this.$preloader)},_hidePreloader:function(){this.$preloader.remove()},_calculatePageHeight:function(t){var e=this._getPagePosition(t);return e.bottom-e.top},_getPagePosition:function(t){var e=this._getLastItemOnPage(t);return{top:this._getFirstItemOnPage(t).offset().top,bottom:e.offset().top+e.outerHeight()}},_getVisiblePage:function(){},_getFirstItemOnPage:function(t){return this.$element.find(this.options.selectors.itemFirst+'[data-page="'+t+'"]')},_getLastItemOnPage:function(t){return this.$element.find(this.options.selectors.itemLast+'[data-page="'+t+'"]')},_pageItemsEnhancment:function(t,e){t.find("> *:first").addClass(this.options.selectors.itemFirst.slice(1)).attr("data-page",e),t.find("> *:last").addClass(this.options.selectors.itemLast.slice(1)).attr("data-page",e)},_delayFunctionCall:function(t,e,i){var a,n=0,o=(new Date).getTime(),s=this;return"function"!=typeof i?!1:(t=t||1,e=e||50,function(){var r=(new Date).getTime(),l=arguments;return r-o>e&&(n=0,o=r),clearTimeout(a),a=setTimeout(function(){i.apply(s,l),o=(new Date).getTime()},e-(r-o)),t>n?(n++,clearTimeout(a),i.apply(s,l)):void 0})},generatePagination:function(t,e,i,a,n){a=a||0,n=n||0;var o,s,r=[],l=[],c=a?2:0,h=n?2:0,u=i+a+n+c/2+h/2,p=Math.ceil((i-1)/2),g=i-1-p,d=!1,f=!1;for(u>=e?r.push({from:1,to:e}):(d=a+c+p>=t,f=t+g+n+h>e,d?r.push({from:1,to:a+c+p+g}):(r.push({from:1,to:a}),c&&r.push("..."),f||r.push({from:t-p,to:t})),f?r.push({from:e+1-g-p-n-h,to:e}):(d||r.push({from:t+1,to:t+g}),h&&r.push("..."),r.push({from:e-n+1,to:e}))),s=0;s<r.length;s++)if(r[s].from)for(var m=r[s].from;m<=r[s].to;m++)o=new Number(m),m===t&&(o.isActive=!0),l.push(o);else l.push(r[s]);return l}},t.fn[n]=function(e){var i=this.first();return i.selector=this.selector+":first",t.data(i,n)||t.data(i,n,new a(i,e)),this}}(jQuery,window,document);
//# sourceMappingURL=jquery.ufi.min.js.map