!function(t,e,i){"use strict";function n(i,n){var a,s=i.data();this.$element=i,this.options=t.extend({},o,s,n),this.$preloader=t(this.options.preloader),a=new RegExp(this.options.url.replace("{number}","(\\d+)"),"i"),this.currentPage=e.location.search.match(a)?e.location.search.match(a):1,this.lastLoadedPage=this.currentPage,this.isLoading=!1,console.log(this.options.pageCount),this.init()}var a="ufiScroll",o={url:e.location.pathname+e.location.search+(e.location.search?"&page={number}":"?page={number}")+e.location.hash,pageCount:null,preloader:'<div class="preloader">Loading...</div>',selectors:{itemFirst:".ufi-item-first",itemLast:".ufi-item-last"}};n.prototype={init:function(){this._pageItemsEnhancment(this.$element,this.currentPage),this._scrollInit()},_scrollInit:function(){var i=this._delayFunctionCall(1,50,this._scrollHandler);t(e).on("scroll.ufi",function(){i()})},_scrollHandler:function(){if(this.lastLoadedPage<this.options.pageCount){var i=t(e).scrollTop()+t(e).height(),n=this._getPagePosition(this.lastLoadedPage),a=.25*(n.bottom-n.top);i>=n.bottom-a&&this._loadPage(this.currentPage+1)}},_loadPage:function(e){var i=this;this.isLoading||(this.isLoading=!0,this._showPreloader(),t.ajax({url:this.options.url.replace("{number}",e),success:function(n){var a=t(n).find(i.$element.selector);a.length||(a=t(n)),i._pageItemsEnhancment(a,e),i.currentPage=e,i.$element.append(a.find(".item")),i.lastLoadedPage=e,i._hidePreloader(),i.isLoading=!1}}))},_showPreloader:function(){this.$element.append(this.$preloader)},_hidePreloader:function(){this.$preloader.remove()},_calculatePageHeight:function(t){var e=this._getPagePosition(t);return e.bottom-e.top},_getPagePosition:function(t){var e=this._getLastItemOnPage(t);return{top:this._getFirstItemOnPage(t).offset().top,bottom:e.offset().top+e.outerHeight()}},_getVisiblePage:function(){},_getFirstItemOnPage:function(t){return this.$element.find(this.options.selectors.itemFirst+'[data-page="'+t+'"]')},_getLastItemOnPage:function(t){return this.$element.find(this.options.selectors.itemLast+'[data-page="'+t+'"]')},_pageItemsEnhancment:function(t,e){t.find("> *:first").addClass(this.options.selectors.itemFirst.slice(1)).attr("data-page",e),t.find("> *:last").addClass(this.options.selectors.itemLast.slice(1)).attr("data-page",e)},_delayFunctionCall:function(t,e,i){var n,a=0,o=(new Date).getTime(),s=this;return"function"!=typeof i?!1:(t=t||1,e=e||50,function(){var r=(new Date).getTime(),l=arguments;return r-o>e&&(a=0,o=r),clearTimeout(n),n=setTimeout(function(){i.apply(s,l),o=(new Date).getTime()},e-(r-o)),t>a?(a++,clearTimeout(n),i.apply(s,l)):void 0})}},t.fn[a]=function(e){var i=this.first();return i.selector=this.selector+":first",t.data(i,a)||t.data(i,a,new n(i,e)),this}}(jQuery,window,document);
//# sourceMappingURL=jquery.ufi.min.js.map