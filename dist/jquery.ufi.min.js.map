{"version":3,"sources":["jquery.ufi.min.js"],"names":["$","window","document","Ufi","$element","options","pageRegExp","data","this","extend","defaults","$preloader","preloader","RegExp","url","replace","currentPage","location","search","match","lastLoadedPage","isLoading","console","log","pageCount","init","pluginName","pathname","hash","selectors","itemFirst","itemLast","prototype","_pageItemsEnhancment","_scrollInit","_scrollHandler","_delayFunctionCall","on","scrollBottom","scrollTop","height","lastLoadedPagePosition","_getPagePosition","prediction","bottom","top","_loadPage","page","self","_showPreloader","ajax","success","html","$content","find","selector","length","append","_hidePreloader","remove","_calculatePageHeight","pagePosition","$itemLast","_getLastItemOnPage","_getFirstItemOnPage","offset","outerHeight","_getVisiblePage","addClass","slice","attr","times","interval","func","timeout","callCount","startTime","Date","getTime","callTime","args","arguments","clearTimeout","setTimeout","apply","fn","first","jQuery"],"mappings":"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","file":"jquery.ufi.min.js","sourcesContent":["/**\n * User friendly infinity scroll\n * Author: @snake_345\n * Licensed under the MIT license\n */\n\n;(function ($, window, document) {\n\t'use strict';\n\n\tvar pluginName = 'ufiScroll';\n\tvar\tdefaults = {\n\t\turl: window.location.pathname +\n\t\t\t window.location.search +\n\t\t\t (window.location.search ? '&page={number}' : '?page={number}') +\n\t\t\t window.location.hash,\n\t\tpageCount: null,\n\t\tpreloader: '<div class=\"preloader\">Loading...</div>',\n\t\tselectors: {\n\t\t\titemFirst: '.ufi-item-first',\n\t\t\titemLast: '.ufi-item-last'\n\t\t}\n\t};\n\n\tfunction Ufi($element, options) {\n\t\tvar pageRegExp;\n\t\tvar data = $element.data();\n\t\tthis.$element = $element;\n\t\tthis.options = $.extend({}, defaults, data, options);\n\t\tthis.$preloader = $(this.options.preloader);\n\n\t\tpageRegExp = new RegExp(this.options.url.replace('{number}', '(\\\\d+)'), 'i');\n\t\tthis.currentPage = window.location.search.match(pageRegExp) ? window.location.search.match(pageRegExp) : 1;\n\t\tthis.lastLoadedPage = this.currentPage;\n\t\tthis.isLoading = false;\n\n\t\tconsole.log(this.options.pageCount);\n\n\t\tthis.init();\n\t}\n\n\tUfi.prototype = {\n\t\tinit: function() {\n\t\t\tthis._pageItemsEnhancment(this.$element, this.currentPage);\n\t\t\tthis._scrollInit();\n\t\t},\n\n\t\t_scrollInit: function() {\n\t\t\tvar _scrollHandler = this._delayFunctionCall(1, 50, this._scrollHandler);\n\t\t\t$(window).on('scroll.ufi', function() {\n\t\t\t\t_scrollHandler();\n\t\t\t});\n\t\t},\n\n\t\t_scrollHandler: function() {\n\t\t\tif (this.lastLoadedPage < this.options.pageCount) {\n\t\t\t\tvar scrollBottom = $(window).scrollTop() + $(window).height();\n\t\t\t\tvar lastLoadedPagePosition = this._getPagePosition(this.lastLoadedPage);\n\t\t\t\tvar prediction = (lastLoadedPagePosition.bottom - lastLoadedPagePosition.top) * 0.25;\n\n\t\t\t\tif ( scrollBottom >= lastLoadedPagePosition.bottom - prediction) {\n\t\t\t\t\tthis._loadPage(this.currentPage + 1);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_loadPage: function(page) {\n\t\t\tvar self = this;\n\t\t\tif (!this.isLoading) {\n\t\t\t\tthis.isLoading = true;\n\t\t\t\tthis._showPreloader();\n\t\t\t\t$.ajax({\n\t\t\t\t\turl: this.options.url.replace('{number}', page),\n\t\t\t\t\tsuccess: function(html) {\n\t\t\t\t\t\tvar $content = $(html).find(self.$element.selector);\n\n\t\t\t\t\t\tif (!$content.length) {\n\t\t\t\t\t\t\t$content = $(html);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tself._pageItemsEnhancment($content, page);\n\t\t\t\t\t\tself.currentPage = page;\n\t\t\t\t\t\tself.$element.append($content.find('.item'));\n\t\t\t\t\t\tself.lastLoadedPage = page;\n\t\t\t\t\t\tself._hidePreloader();\n\t\t\t\t\t\tself.isLoading = false;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t},\n\n\t\t_showPreloader: function() {\n\t\t\tthis.$element.append(this.$preloader);\n\t\t},\n\n\t\t_hidePreloader: function() {\n\t\t\tthis.$preloader.remove();\n\t\t},\n\n\t\t_calculatePageHeight: function(page) {\n\t\t\tvar pagePosition = this._getPagePosition(page);\n\n\t\t\treturn pagePosition.bottom - pagePosition.top;\n\t\t},\n\n\t\t_getPagePosition: function(page) {\n\t\t\tvar $itemLast = this._getLastItemOnPage(page);\n\n\t\t\treturn {\n\t\t\t\ttop: this._getFirstItemOnPage(page).offset().top,\n\t\t\t\tbottom: $itemLast.offset().top + $itemLast.outerHeight()\n\t\t\t}\n\t\t},\n\n\t\t_getVisiblePage: function() {\n\n\t\t},\n\n\t\t_getFirstItemOnPage: function(page) {\n\t\t\treturn this.$element.find(this.options.selectors.itemFirst + '[data-page=\"' + page + '\"]');\n\t\t},\n\n\t\t_getLastItemOnPage: function(page) {\n\t\t\treturn this.$element.find(this.options.selectors.itemLast + '[data-page=\"' + page + '\"]');\n\t\t},\n\n\t\t_pageItemsEnhancment: function($element, page) {\n\t\t\t$element.find('> *:first')\n\t\t\t\t.addClass(this.options.selectors.itemFirst.slice(1))\n\t\t\t\t.attr('data-page', page);\n\t\t\t$element.find('> *:last')\n\t\t\t\t.addClass(this.options.selectors.itemLast.slice(1))\n\t\t\t\t.attr('data-page', page);\n\t\t},\n\n\t\t_delayFunctionCall: function(times, interval, func) {\n\t\t\tvar callCount = 0;\n\t\t\tvar startTime = (new Date()).getTime();\n\t\t\tvar timeout;\n\t\t\tvar self = this;\n\t\t\tif (typeof func !== 'function') return false;\n\t\t\ttimes = times || 1;\n\t\t\tinterval = interval || 50;\n\n\t\t\treturn function() {\n\t\t\t\tvar callTime = (new Date()).getTime();\n\t\t\t\tvar args = arguments;\n\n\t\t\t\tif (callTime - startTime > interval) {\n\t\t\t\t\tcallCount = 0;\n\t\t\t\t\tstartTime = callTime;\n\t\t\t\t}\n\n\t\t\t\tclearTimeout(timeout);\n\t\t\t\ttimeout = setTimeout(function() {\n\t\t\t\t\tfunc.apply(self, args);\n\t\t\t\t\tstartTime = (new Date()).getTime();\n\t\t\t\t}, interval - (callTime - startTime));\n\n\t\t\t\tif (callCount < times) {\n\t\t\t\t\tcallCount++;\n\t\t\t\t\tclearTimeout(timeout);\n\t\t\t\t\treturn func.apply(self, args);\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t};\n\n\t$.fn[pluginName] = function ( options ) {\n\t\tvar $element = this.first();\n\t\t$element.selector = this.selector + ':first';\n\t\tif (!$.data($element, pluginName)) {\n\t\t\t$.data($element, pluginName,\n\t\t\t\tnew Ufi($element, options));\n\t\t}\n\t\treturn this;\n\t};\n\n})(jQuery, window, document);\n"],"sourceRoot":"/source/"}