{"version":3,"sources":["jquery.ufi.min.js"],"names":["$","window","document","Ufi","$element","options","pageRegExp","data","this","extend","defaults","$preloader","preloader","RegExp","url","replace","currentPage","location","search","match","lastLoadedPage","isLoading","init","pluginName","pathname","hash","pageCount","selectors","itemFirst","itemLast","pagination","current","$tempEl","$pagination","$page","$separator","paginationRaw","generatePagination","i","length","clone","text","isActive","addClass","append","find","replaceWith","prototype","_pageItemsEnhancment","_scrollInit","call","_scrollHandler","_delayFunctionCall","on","scrollBottom","scrollTop","height","lastLoadedPagePosition","_getPagePosition","prediction","bottom","top","_loadPage","page","self","_showPreloader","ajax","success","html","$content","selector","_hidePreloader","remove","_calculatePageHeight","pagePosition","$itemLast","_getLastItemOnPage","_getFirstItemOnPage","offset","outerHeight","_getVisiblePage","slice","attr","times","interval","func","timeout","callCount","startTime","Date","getTime","callTime","args","arguments","clearTimeout","setTimeout","apply","countPages","pages","firstPages","lastPages","number","ranges","result","firstHidedPages","lastHidedPages","minimumPages","beforeCurrentPage","Math","ceil","afterCurrentPage","isFirstEnhancment","isLastEnhancment","push","from","to","j","Number","fn","first","jQuery"],"mappings":"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","file":"jquery.ufi.min.js","sourcesContent":["/**\n * User friendly infinity scroll\n * Author: @snake_345\n * Licensed under the MIT license\n */\n\n;(function ($, window, document) {\n\t'use strict';\n\n\tvar pluginName = 'ufiScroll';\n\tvar\tdefaults = {\n\t\turl: window.location.pathname +\n\t\t\t window.location.search +\n\t\t\t (window.location.search ? '&page={number}' : '?page={number}') +\n\t\t\t window.location.hash,\n\t\tpageCount: null,\n\t\tpreloader: '<div class=\"preloader\">Loading...</div>',\n\t\tselectors: {\n\t\t\titemFirst: '.ufi-item-first',\n\t\t\titemLast: '.ufi-item-last'\n\t\t},\n\t\tpagination: function(current) {\n\t\t\tvar $pagination = $('<div class=\"ufi-pagination\"/>');\n\t\t\tvar $page = $('<a href=\"#\" class=\"ufi-pagination_page\"/>');\n\t\t\tvar $separator = $('<span class=\"ufi-pagination_separator\">...</span>');\n\t\t\tvar paginationRaw = this.generatePagination(current, this.options.pageCount, 3, 1, 1);\n\t\t\tvar $tempEl;\n\n\t\t\tfor (var i = 0; i < paginationRaw.length; i++) {\n\t\t\t\tif (typeof paginationRaw[i] !== 'string') {\n\t\t\t\t\t$tempEl = $page.clone();\n\t\t\t\t\t$tempEl.text(paginationRaw[i]);\n\t\t\t\t\tif (paginationRaw[i].isActive) {\n\t\t\t\t\t\t$tempEl.addClass('_active');\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t$tempEl = $separator.clone();\n\t\t\t\t}\n\n\t\t\t\t$pagination.append($tempEl);\n\t\t\t}\n\n\t\t\tif ($('body').find('.ufi-pagination').length) {\n\t\t\t\t$('body').find('.ufi-pagination').replaceWith($pagination);\n\t\t\t} else {\n\t\t\t\t$('body').append($pagination);\n\t\t\t}\n\t\t}\n\t};\n\n\tfunction Ufi($element, options) {\n\t\tvar pageRegExp;\n\t\tvar data = $element.data();\n\t\tthis.$element = $element;\n\t\tthis.options = $.extend({}, defaults, data, options);\n\t\tthis.$preloader = $(this.options.preloader);\n\n\t\tpageRegExp = new RegExp(this.options.url.replace('{number}', '(\\\\d+)'), 'i');\n\t\tthis.currentPage = window.location.search.match(pageRegExp) ? window.location.search.match(pageRegExp) : 1;\n\t\tthis.lastLoadedPage = this.currentPage;\n\t\tthis.isLoading = false;\n\n\t\tthis.init();\n\t}\n\n\tUfi.prototype = {\n\t\tinit: function() {\n\t\t\tthis._pageItemsEnhancment(this.$element, this.currentPage);\n\t\t\tthis._scrollInit();\n\t\t\tthis.options.pagination.call(this, this.currentPage);\n\t\t},\n\n\t\t_scrollInit: function() {\n\t\t\tvar _scrollHandler = this._delayFunctionCall(1, 50, this._scrollHandler);\n\t\t\t$(window).on('scroll.ufi', function() {\n\t\t\t\t_scrollHandler();\n\t\t\t});\n\t\t},\n\n\t\t_scrollHandler: function() {\n\t\t\tif (this.lastLoadedPage < this.options.pageCount) {\n\t\t\t\tvar scrollBottom = $(window).scrollTop() + $(window).height();\n\t\t\t\tvar lastLoadedPagePosition = this._getPagePosition(this.lastLoadedPage);\n\t\t\t\tvar prediction = (lastLoadedPagePosition.bottom - lastLoadedPagePosition.top) * 0.25;\n\n\t\t\t\tif ( scrollBottom >= lastLoadedPagePosition.bottom - prediction) {\n\t\t\t\t\tthis._loadPage(this.currentPage + 1);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_loadPage: function(page) {\n\t\t\tvar self = this;\n\t\t\tif (!this.isLoading) {\n\t\t\t\tthis.isLoading = true;\n\t\t\t\tthis._showPreloader();\n\t\t\t\t$.ajax({\n\t\t\t\t\turl: this.options.url.replace('{number}', page),\n\t\t\t\t\tsuccess: function(html) {\n\t\t\t\t\t\tvar $content = $(html).find(self.$element.selector);\n\n\t\t\t\t\t\tif (!$content.length) {\n\t\t\t\t\t\t\t$content = $(html);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tself._pageItemsEnhancment($content, page);\n\t\t\t\t\t\tself.currentPage = page;\n\t\t\t\t\t\tself.$element.append($content.find('.item'));\n\t\t\t\t\t\tself.lastLoadedPage = page;\n\t\t\t\t\t\tself._hidePreloader();\n\t\t\t\t\t\tself.isLoading = false;\n\t\t\t\t\t\tself.options.pagination.call(self, self.currentPage);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t},\n\n\t\t_showPreloader: function() {\n\t\t\tthis.$element.append(this.$preloader);\n\t\t},\n\n\t\t_hidePreloader: function() {\n\t\t\tthis.$preloader.remove();\n\t\t},\n\n\t\t_calculatePageHeight: function(page) {\n\t\t\tvar pagePosition = this._getPagePosition(page);\n\n\t\t\treturn pagePosition.bottom - pagePosition.top;\n\t\t},\n\n\t\t_getPagePosition: function(page) {\n\t\t\tvar $itemLast = this._getLastItemOnPage(page);\n\n\t\t\treturn {\n\t\t\t\ttop: this._getFirstItemOnPage(page).offset().top,\n\t\t\t\tbottom: $itemLast.offset().top + $itemLast.outerHeight()\n\t\t\t}\n\t\t},\n\n\t\t_getVisiblePage: function() {\n\n\t\t},\n\n\t\t_getFirstItemOnPage: function(page) {\n\t\t\treturn this.$element.find(this.options.selectors.itemFirst + '[data-page=\"' + page + '\"]');\n\t\t},\n\n\t\t_getLastItemOnPage: function(page) {\n\t\t\treturn this.$element.find(this.options.selectors.itemLast + '[data-page=\"' + page + '\"]');\n\t\t},\n\n\t\t_pageItemsEnhancment: function($element, page) {\n\t\t\t$element.find('> *:first')\n\t\t\t\t.addClass(this.options.selectors.itemFirst.slice(1))\n\t\t\t\t.attr('data-page', page);\n\t\t\t$element.find('> *:last')\n\t\t\t\t.addClass(this.options.selectors.itemLast.slice(1))\n\t\t\t\t.attr('data-page', page);\n\t\t},\n\n\t\t_delayFunctionCall: function(times, interval, func) {\n\t\t\tvar callCount = 0;\n\t\t\tvar startTime = (new Date()).getTime();\n\t\t\tvar timeout;\n\t\t\tvar self = this;\n\t\t\tif (typeof func !== 'function') return false;\n\t\t\ttimes = times || 1;\n\t\t\tinterval = interval || 50;\n\n\t\t\treturn function() {\n\t\t\t\tvar callTime = (new Date()).getTime();\n\t\t\t\tvar args = arguments;\n\n\t\t\t\tif (callTime - startTime > interval) {\n\t\t\t\t\tcallCount = 0;\n\t\t\t\t\tstartTime = callTime;\n\t\t\t\t}\n\n\t\t\t\tclearTimeout(timeout);\n\t\t\t\ttimeout = setTimeout(function() {\n\t\t\t\t\tfunc.apply(self, args);\n\t\t\t\t\tstartTime = (new Date()).getTime();\n\t\t\t\t}, interval - (callTime - startTime));\n\n\t\t\t\tif (callCount < times) {\n\t\t\t\t\tcallCount++;\n\t\t\t\t\tclearTimeout(timeout);\n\t\t\t\t\treturn func.apply(self, args);\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\n\t\tgeneratePagination: function(currentPage, countPages, pages, firstPages, lastPages) {\n\t\t\tfirstPages = firstPages || 0;\n\t\t\tlastPages = lastPages || 0;\n\t\t\tvar ranges = [];\n\t\t\tvar result = [];\n\t\t\tvar firstHidedPages = firstPages ? 2 : 0;\n\t\t\tvar lastHidedPages = lastPages ? 2 : 0;\n\t\t\tvar minimumPages = pages + firstPages + lastPages + firstHidedPages / 2 + lastHidedPages / 2;\n\t\t\tvar beforeCurrentPage = Math.ceil((pages - 1) / 2);\n\t\t\tvar afterCurrentPage = pages - 1 - beforeCurrentPage;\n\t\t\tvar isFirstEnhancment = false;\n\t\t\tvar isLastEnhancment = false;\n\t\t\tvar number, i;\n\n\t\t\tif (countPages <= minimumPages) {\n\t\t\t\tranges.push({\n\t\t\t\t\tfrom: 1,\n\t\t\t\t\tto: countPages\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tisFirstEnhancment = currentPage <= firstPages + firstHidedPages + beforeCurrentPage;\n\t\t\t\tisLastEnhancment = currentPage + afterCurrentPage + lastPages + lastHidedPages > countPages;\n\n\t\t\t\tif (isFirstEnhancment) {\n\t\t\t\t\tranges.push({\n\t\t\t\t\t\tfrom: 1,\n\t\t\t\t\t\tto: firstPages + firstHidedPages + beforeCurrentPage + afterCurrentPage\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tranges.push({\n\t\t\t\t\t\tfrom: 1,\n\t\t\t\t\t\tto: firstPages\n\t\t\t\t\t});\n\t\t\t\t\tif (firstHidedPages) {\n\t\t\t\t\t\tranges.push('...');\n\t\t\t\t\t}\n\t\t\t\t\tif (!isLastEnhancment) {\n\t\t\t\t\t\tranges.push({\n\t\t\t\t\t\t\tfrom: currentPage - beforeCurrentPage,\n\t\t\t\t\t\t\tto: currentPage\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (isLastEnhancment) {\n\t\t\t\t\tranges.push({\n\t\t\t\t\t\tfrom: countPages + 1 - afterCurrentPage - beforeCurrentPage - lastPages - lastHidedPages,\n\t\t\t\t\t\tto: countPages\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tif (!isFirstEnhancment) {\n\t\t\t\t\t\tranges.push({\n\t\t\t\t\t\t\tfrom: currentPage + 1,\n\t\t\t\t\t\t\tto: currentPage + afterCurrentPage\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tif (lastHidedPages) {\n\t\t\t\t\t\tranges.push('...');\n\t\t\t\t\t}\n\t\t\t\t\tranges.push({\n\t\t\t\t\t\tfrom: countPages - lastPages + 1,\n\t\t\t\t\t\tto: countPages\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (i = 0; i < ranges.length; i++) {\n\t\t\t\tif (ranges[i].from) { // кря\n\t\t\t\t\tfor (var j = ranges[i].from; j <= ranges[i].to; j++) {\n\t\t\t\t\t\tnumber = new Number(j);\n\t\t\t\t\t\tif (j === currentPage) {\n\t\t\t\t\t\t\tnumber.isActive = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresult.push(number);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tresult.push(ranges[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\t};\n\n\t$.fn[pluginName] = function ( options ) {\n\t\tvar $element = this.first();\n\t\t$element.selector = this.selector + ':first';\n\t\tif (!$.data($element, pluginName)) {\n\t\t\t$.data($element, pluginName,\n\t\t\t\tnew Ufi($element, options));\n\t\t}\n\t\treturn this;\n\t};\n\n})(jQuery, window, document);"],"sourceRoot":"/source/"}