{"version":3,"sources":["jquery.ufi.min.js"],"names":["$","window","document","Ufi","$element","options","pageRegExp","data","this","extend","defaults","$preloader","preloader","RegExp","url","replace","currentPage","location","search","match","lastLoadedPage","isLoading","pages","init","pluginName","pathname","hash","pageCount","selectors","itemFirst","itemLast","pagination","current","$tempEl","$pagination","$page","$separator","paginationRaw","generatePagination","i","length","clone","text","isActive","addClass","append","find","replaceWith","prototype","_pageItemsEnhancment","_getPagePosition","_scrollInit","call","_scrollHandler","_delayFunctionCall","self","_loadPage","setTimeout","on","scrollTop","winHeight","height","scrollBottom","lastLoadedPagePosition","prediction","bottom","top","_improveScrollTop","_getVisiblePage","page","_showPreloader","ajax","success","html","$content","selector","_hidePreloader","remove","lastPageFit","_getLastPageFit","lastPageFitTop","docHeight","documentElement","scrollHeight","clientHeight","remainder","modificator","_calculatePageHeight","pagePosition","$itemLast","_getLastItemOnPage","_getFirstItemOnPage","offset","outerHeight","slice","attr","times","interval","func","timeout","callCount","startTime","Date","getTime","callTime","args","arguments","clearTimeout","apply","countPages","firstPages","lastPages","number","ranges","result","firstHidedPages","lastHidedPages","minimumPages","beforeCurrentPage","Math","ceil","afterCurrentPage","isFirstEnhancment","isLastEnhancment","push","from","to","max","j","Number","fn","first","jQuery"],"mappings":"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","file":"jquery.ufi.min.js","sourcesContent":["/**\n * User friendly infinity scroll\n * Author: @snake_345\n * Licensed under the MIT license\n */\n\n;(function ($, window, document) {\n\t'use strict';\n\n\tvar pluginName = 'ufiScroll';\n\tvar\tdefaults = {\n\t\turl: window.location.pathname +\n\t\t\t window.location.search +\n\t\t\t (window.location.search ? '&page={number}' : '?page={number}') +\n\t\t\t window.location.hash,\n\t\tpageCount: null,\n\t\tpreloader: '<div class=\"preloader\">Loading...</div>',\n\t\tselectors: {\n\t\t\titemFirst: '.ufi-item-first',\n\t\t\titemLast: '.ufi-item-last'\n\t\t},\n\t\tpagination: function(current) {\n\t\t\tvar $pagination = $('<div class=\"ufi-pagination\"/>');\n\t\t\tvar $page = $('<a href=\"#\" class=\"ufi-pagination_page\"/>');\n\t\t\tvar $separator = $('<span class=\"ufi-pagination_separator\">...</span>');\n\t\t\tvar paginationRaw = this.generatePagination(current, this.options.pageCount, 3, 1, 1);\n\t\t\tvar $tempEl;\n\n\t\t\tfor (var i = 0; i < paginationRaw.length; i++) {\n\t\t\t\tif (typeof paginationRaw[i] !== 'string') {\n\t\t\t\t\t$tempEl = $page.clone();\n\t\t\t\t\t$tempEl.text(paginationRaw[i]);\n\t\t\t\t\tif (paginationRaw[i].isActive) {\n\t\t\t\t\t\t$tempEl.addClass('_active');\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t$tempEl = $separator.clone();\n\t\t\t\t}\n\n\t\t\t\t$pagination.append($tempEl);\n\t\t\t}\n\n\t\t\tif ($('body').find('.ufi-pagination').length) {\n\t\t\t\t$('body').find('.ufi-pagination').replaceWith($pagination);\n\t\t\t} else {\n\t\t\t\t$('body').append($pagination);\n\t\t\t}\n\t\t}\n\t};\n\n\tfunction Ufi($element, options) {\n\t\tvar pageRegExp;\n\t\tvar data = $element.data();\n\t\tthis.$element = $element;\n\t\tthis.options = $.extend({}, defaults, data, options);\n\t\tthis.$preloader = $(this.options.preloader);\n\n\t\tpageRegExp = new RegExp(this.options.url.replace('{number}', '(\\\\d+)'), 'i');\n\t\tthis.currentPage = window.location.search.match(pageRegExp) ? window.location.search.match(pageRegExp) : 1;\n\t\tthis.lastLoadedPage = this.currentPage;\n\t\tthis.isLoading = false;\n\t\tthis.pages = [];\n\n\t\tthis.init();\n\t}\n\n\tUfi.prototype = {\n\t\tinit: function() {\n\t\t\tthis._pageItemsEnhancment(this.$element, this.currentPage);\n\t\t\tthis.pages[this.lastLoadedPage] = this._getPagePosition(this.lastLoadedPage);\n\t\t\tthis._scrollInit();\n\t\t\tthis.options.pagination.call(this, this.currentPage);\n\t\t},\n\n\t\t_scrollInit: function() {\n\t\t\tvar _scrollHandler = this._delayFunctionCall(1, 50, this._scrollHandler);\n\n\t\t\t/***********************\n\t\t\t * Временное решение\n\t\t\t ***********************/\n\t\t\t// TODO: дописать подгрузку нужного количества страниц\n\t\t\tvar self = this;\n\t\t\tthis._loadPage(2);\n\n\t\t\tsetTimeout(function() {\n\t\t\t\tself._loadPage(3);\n\t\t\t}, 300);\n\t\t\tsetTimeout(function() {\n\t\t\t\tself._loadPage(4);\n\t\t\t}, 600);\n\t\t\tsetTimeout(function() {\n\t\t\t\tself._loadPage(5);\n\t\t\t}, 900);\n\t\t\t/***********************\n\t\t\t * Временное решение\n\t\t\t ***********************/\n\n\t\t\t$(window).on('scroll.ufi', function() {\n\t\t\t\t_scrollHandler();\n\t\t\t});\n\t\t},\n\n\t\t_scrollHandler: function() {\n\t\t\tvar scrollTop = $(window).scrollTop();\n\t\t\tvar winHeight = $(window).height();\n\t\t\tvar scrollBottom = scrollTop + winHeight;\n\t\t\tvar lastLoadedPagePosition = this.pages[this.lastLoadedPage];\n\t\t\tvar prediction = (lastLoadedPagePosition.bottom - lastLoadedPagePosition.top) * 0.25;\n\n\t\t\tscrollTop = this._improveScrollTop(scrollTop);\n\n\t\t\tif (this.lastLoadedPage < this.options.pageCount) {\n\t\t\t\tif (scrollBottom >= lastLoadedPagePosition.bottom - prediction) {\n\t\t\t\t\tthis._loadPage(this.lastLoadedPage + 1);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.currentPage !== this._getVisiblePage(scrollTop)) {\n\t\t\t\tthis.currentPage = this._getVisiblePage(scrollTop);\n\t\t\t\tthis.options.pagination.call(this, this.currentPage);\n\t\t\t}\n\t\t},\n\n\t\t_loadPage: function(page) {\n\t\t\tvar self = this;\n\t\t\tif (!this.isLoading) {\n\t\t\t\tthis.isLoading = true;\n\t\t\t\tthis._showPreloader();\n\t\t\t\t$.ajax({\n\t\t\t\t\turl: this.options.url.replace('{number}', page),\n\t\t\t\t\tsuccess: function(html) {\n\t\t\t\t\t\tvar $content = $(html).find(self.$element.selector);\n\n\t\t\t\t\t\tif (!$content.length) {\n\t\t\t\t\t\t\t$content = $(html);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tself._pageItemsEnhancment($content, page);\n\t\t\t\t\t\tself.currentPage = page;\n\t\t\t\t\t\tself.$element.append($content.find('.item'));\n\t\t\t\t\t\tself.lastLoadedPage = page;\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tself.pages[page] = self._getPagePosition(page);\n\t\t\t\t\t\t}, 0);\n\t\t\t\t\t\tself._hidePreloader();\n\t\t\t\t\t\tself.isLoading = false;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t},\n\n\t\t_showPreloader: function() {\n\t\t\tthis.$element.append(this.$preloader);\n\t\t},\n\n\t\t_hidePreloader: function() {\n\t\t\tthis.$preloader.remove();\n\t\t},\n\n\t\t_improveScrollTop: function(scrollTop) {\n\t\t\t// Последние страницы, могут быть слишком маленькими по высоте и тогда их верхняя граница\n\t\t\t// никогда не пересекёт scrollTop, таким образом нет возможности определить,\n\t\t\t// что они уже видимы и соответсвующе перестроить пагинацию.\n\t\t\t// Тоесть у пагинации не будет возможности определить последнии страницы и они никогда не станут активными.\n\t\t\t// Для борьбы с этой проблемой в данной функции реализовано следующее решение:\n\t\t\t//   - Получаем номер последней страницы верхняя граница которой меньше максимального scrollTop\n\t\t\t//   - расчитываем сколько мы ещё можем прокуртить после этой страницы\n\t\t\t//   - если прокрутить можно меньше чем 300 пикселей, двигаем верхнюю границу найденной страницы так, чтобы после\n\t\t\t//     определения, что это активная страница, можно было прокрутить ещё 300 пикселей\n\t\t\t//   - увеличиваем scrollTop относительно прокрученного остатка\n\t\t\t//   - таким образом добиваемся что мнимый scrollTop пересекет верхние границы всех страниц\n\t\t\tif (this.lastLoadedPage === this.options.pageCount) { // Если последняя страница загружена\n\t\t\t\tvar lastPageFit = this._getLastPageFit();                       // последняя страница top которой меньше максимального scrollTop\n\t\t\t\tif (lastPageFit === this.options.pageCount) return scrollTop;   // если это самая последняя страница, то модифицировать scrollTop нет необходимости\n\t\t\t\tvar lastPageFitTop = this.pages[lastPageFit].top;\n\t\t\t\tvar docHeight = document.documentElement.scrollHeight;\n\t\t\t\tvar winHeight = document.documentElement.clientHeight;\n\t\t\t\tvar remainder = docHeight - (lastPageFitTop + winHeight); // сколько ещё будет возможно прокрутить после верхней границы lastPageFit\n\n\t\t\t\t// Когда остаток слишком мал, последние страницы слишком быстро переключаются, поэтому\n\t\t\t\tif (remainder < 300) {                      // если остаток меньше 300, то\n\t\t\t\t\tlastPageFitTop -= 300 - remainder;      // двигаем верхнюю границу последней вмещающейся страницы на разницу между 300 и текущим остатком\n\t\t\t\t\tremainder = 300;                        // устанавливаем значение остатка в 300;\n\t\t\t\t}\n\n\t\t\t\t// увеличиваем scrollTop относительно того, сколько из пощитанного нами остатка уже прокрутили\n\t\t\t\tvar modificator = winHeight * ((scrollTop - lastPageFitTop) / remainder);\n\n\t\t\t\tif (scrollTop > lastPageFitTop) {\n\t\t\t\t\tscrollTop += modificator;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn scrollTop;\n\t\t},\n\n\t\t_calculatePageHeight: function(page) {\n\t\t\tvar pagePosition = this._getPagePosition(page);\n\n\t\t\treturn pagePosition.bottom - pagePosition.top;\n\t\t},\n\n\t\t_getPagePosition: function(page) {\n\t\t\tvar $itemLast = this._getLastItemOnPage(page);\n\n\t\t\treturn {\n\t\t\t\ttop: this._getFirstItemOnPage(page).offset().top,\n\t\t\t\tbottom: $itemLast.offset().top + $itemLast.outerHeight()\n\t\t\t}\n\t\t},\n\n\t\t_getLastPageFit: function() {\n\t\t\tfor (var i = this.pages.length - 1; i > 0; i--) {\n\t\t\t\tif (document.documentElement.scrollHeight - this.pages[i].top > document.documentElement.clientHeight) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn i;\n\t\t},\n\n\t\t_getVisiblePage: function(scrollTop) {\n\t\t\tfor (var i = this.pages.length - 1; i > 0; i--) {\n\t\t\t\tif (scrollTop >= this.pages[i].top && scrollTop <= this.pages[i].bottom) {\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn this.currentPage;\n\t\t},\n\n\t\t_getFirstItemOnPage: function(page) {\n\t\t\treturn this.$element.find(this.options.selectors.itemFirst + '[data-page=\"' + page + '\"]');\n\t\t},\n\n\t\t_getLastItemOnPage: function(page) {\n\t\t\treturn this.$element.find(this.options.selectors.itemLast + '[data-page=\"' + page + '\"]');\n\t\t},\n\n\t\t_pageItemsEnhancment: function($element, page) {\n\t\t\t$element.find('> *:first')\n\t\t\t\t.addClass(this.options.selectors.itemFirst.slice(1))\n\t\t\t\t.attr('data-page', page);\n\t\t\t$element.find('> *:last')\n\t\t\t\t.addClass(this.options.selectors.itemLast.slice(1))\n\t\t\t\t.attr('data-page', page);\n\t\t},\n\n\t\t_delayFunctionCall: function(times, interval, func) {\n\t\t\tvar callCount = 0;\n\t\t\tvar startTime = (new Date()).getTime();\n\t\t\tvar timeout;\n\t\t\tvar self = this;\n\t\t\tif (typeof func !== 'function') return false;\n\t\t\ttimes = times || 1;\n\t\t\tinterval = interval || 50;\n\n\t\t\treturn function() {\n\t\t\t\tvar callTime = (new Date()).getTime();\n\t\t\t\tvar args = arguments;\n\n\t\t\t\tif (callTime - startTime > interval) {\n\t\t\t\t\tcallCount = 0;\n\t\t\t\t\tstartTime = callTime;\n\t\t\t\t}\n\n\t\t\t\tclearTimeout(timeout);\n\t\t\t\ttimeout = setTimeout(function() {\n\t\t\t\t\tfunc.apply(self, args);\n\t\t\t\t\tstartTime = (new Date()).getTime();\n\t\t\t\t}, interval - (callTime - startTime));\n\n\t\t\t\tif (callCount < times) {\n\t\t\t\t\tcallCount++;\n\t\t\t\t\tclearTimeout(timeout);\n\t\t\t\t\treturn func.apply(self, args);\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\n\t\tgeneratePagination: function(currentPage, countPages, pages, firstPages, lastPages) {\n\t\t\tpages = pages || 1;\n\t\t\tfirstPages = firstPages || 0;\n\t\t\tlastPages = lastPages || 0;\n\t\t\tvar ranges = [];\n\t\t\tvar result = [];\n\t\t\tvar firstHidedPages = firstPages ? 2 : 0;\n\t\t\tvar lastHidedPages = lastPages ? 2 : 0;\n\t\t\tvar minimumPages = pages + firstPages + lastPages + firstHidedPages / 2 + lastHidedPages / 2;\n\t\t\tvar beforeCurrentPage = Math.ceil((pages - 1) / 2);\n\t\t\tvar afterCurrentPage = pages - 1 - beforeCurrentPage;\n\t\t\tvar isFirstEnhancment = false;\n\t\t\tvar isLastEnhancment = false;\n\t\t\tvar number, i;\n\n\t\t\tif (countPages <= minimumPages) {\n\t\t\t\tranges.push({\n\t\t\t\t\tfrom: 1,\n\t\t\t\t\tto: countPages\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tisFirstEnhancment = currentPage <= firstPages + firstHidedPages + beforeCurrentPage;\n\t\t\t\tisLastEnhancment = currentPage + afterCurrentPage + lastPages + lastHidedPages > countPages;\n\n\t\t\t\tif (isFirstEnhancment) {\n\t\t\t\t\tranges.push({\n\t\t\t\t\t\tfrom: 1,\n\t\t\t\t\t\tto: Math.max(firstPages, 1) + firstHidedPages + beforeCurrentPage + afterCurrentPage\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tranges.push({\n\t\t\t\t\t\tfrom: 1,\n\t\t\t\t\t\tto: firstPages\n\t\t\t\t\t});\n\t\t\t\t\tif (firstHidedPages) {\n\t\t\t\t\t\tranges.push('...');\n\t\t\t\t\t}\n\t\t\t\t\tif (!isLastEnhancment) {\n\t\t\t\t\t\tranges.push({\n\t\t\t\t\t\t\tfrom: currentPage - beforeCurrentPage,\n\t\t\t\t\t\t\tto: currentPage\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (isLastEnhancment) {\n\t\t\t\t\tranges.push({\n\t\t\t\t\t\tfrom: countPages + 1 - afterCurrentPage - beforeCurrentPage - Math.max(lastPages, 1) - lastHidedPages,\n\t\t\t\t\t\tto: countPages\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tif (!isFirstEnhancment) {\n\t\t\t\t\t\tranges.push({\n\t\t\t\t\t\t\tfrom: currentPage + 1,\n\t\t\t\t\t\t\tto: currentPage + afterCurrentPage\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tif (lastHidedPages) {\n\t\t\t\t\t\tranges.push('...');\n\t\t\t\t\t}\n\t\t\t\t\tranges.push({\n\t\t\t\t\t\tfrom: countPages - lastPages + 1,\n\t\t\t\t\t\tto: countPages\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (i = 0; i < ranges.length; i++) {\n\t\t\t\tif (ranges[i].from) { // кря\n\t\t\t\t\tfor (var j = ranges[i].from; j <= ranges[i].to; j++) {\n\t\t\t\t\t\tnumber = new Number(j);\n\t\t\t\t\t\tif (j === currentPage) {\n\t\t\t\t\t\t\tnumber.isActive = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresult.push(number);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tresult.push(ranges[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\t};\n\n\t$.fn[pluginName] = function ( options ) {\n\t\tvar $element = this.first();\n\t\t$element.selector = this.selector + ':first';\n\t\tif (!$.data($element, pluginName)) {\n\t\t\t$.data($element, pluginName,\n\t\t\t\tnew Ufi($element, options));\n\t\t}\n\t\treturn this;\n\t};\n\n})(jQuery, window, document);"],"sourceRoot":"/source/"}